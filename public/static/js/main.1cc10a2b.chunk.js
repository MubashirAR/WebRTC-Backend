(this["webpackJsonpreact-webrtc"]=this["webpackJsonpreact-webrtc"]||[]).push([[0],{31:function(e,t,n){e.exports=n(67)},36:function(e,t,n){},38:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},39:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){},64:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(28),o=n.n(c),s=(n(36),n(7)),i=n(1),u=n.n(i),l=n(2),d=n(3),p=(n(38),n(39),n(14)),m=n(11),f=n(8),v=n.n(f);v.a.defaults.withCredentials=!0;var h={"Content-Type":"application/json",crossDomain:!0,credentials:"cross-origin"},g={withCredentials:!0,credentials:"same-origin"},b=document.URL.split("/");b=b.length>2&&b[2].includes("localhost")?"":"https://mubashir-video-chat.herokuapp.com",b="/api";var w=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v()(Object(s.a)({url:b+"/login",method:"POST",headers:h,data:JSON.stringify(t)},g));case 3:return n=e.sent,r=n.data,e.abrupt("return",r);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0.response.data;case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(l.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v()(Object(s.a)({url:b+"/logout",method:"POST",headers:h},g));case 3:return t=e.sent,n=t.data,e.abrupt("return",n);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0.response.data;case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v()(Object(s.a)({url:b+"/register",method:"POST",headers:h,data:JSON.stringify(t)},g));case 3:return n=e.sent,r=n.data,e.abrupt("return",r);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0.response.data;case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),O={me:function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v()(Object(s.a)({url:b+"/me",method:"get",headers:h},g));case 3:return n=e.sent,r=n.data,e.abrupt("return",r);case 8:throw e.prev=8,e.t0=e.catch(0),console.log({error:e.t0}),e.t0.response.data;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),login:w,logout:E,register:x};v.a.defaults.withCredentials=!0;var y={"Content-Type":"application/json",crossDomain:!0,credentials:"cross-origin"},j={withCredentials:!0,credentials:"same-origin"},k=document.URL.split("/");k=k.length>2&&k[2].includes("localhost")?"":"https://mubashir-video-chat.herokuapp.com",k="/api";var C={getConnections:function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v()(Object(s.a)({url:k+"/connection",method:"GET",headers:y},j));case 3:return n=e.sent,r=n.data,e.abrupt("return",r);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0.response.data;case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),addConnection:function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.connectionId,e.prev=1,e.next=4,v()(Object(s.a)({url:k+"/user/addConnection",method:"PUT",headers:y,data:JSON.stringify({connectionId:n})},j));case 4:return r=e.sent,a=r.data,e.abrupt("return",a);case 9:throw e.prev=9,e.t0=e.catch(1),e.t0.response.data;case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),removeConnection:function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.connectionId,e.prev=1,e.next=4,v()(Object(s.a)({url:k+"/user/removeConnection",method:"PUT",headers:y,data:JSON.stringify({connectionId:n})},j));case 4:return r=e.sent,a=r.data,e.abrupt("return",a);case 9:throw e.prev=9,e.t0=e.catch(1),e.t0.response.data;case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),searchUser:function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log({params:t}),e.prev=1,e.next=4,v()(Object(s.a)({url:k+"/user/search",method:"GET",headers:y,params:t},j));case 4:return n=e.sent,r=n.data,e.abrupt("return",r);case 9:throw e.prev=9,e.t0=e.catch(1),e.t0.response.data;case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()},S=a.a.createContext({}),L=(n(57),function(){var e=Object(r.useContext)(S).data.loggedInUser,t=void 0===e?{}:e;return a.a.createElement("div",{className:"header"},a.a.createElement("div",{className:"welcome-msg"},"Welcome ",t.username),a.a.createElement("div",null,a.a.createElement("ul",null,t.username?a.a.createElement("a",{href:"/connect"},a.a.createElement("li",null,"Call")):a.a.createElement(r.Fragment,null,a.a.createElement("a",{href:"/login"},a.a.createElement("li",null,"Login")),a.a.createElement("a",{href:"/register"},a.a.createElement("li",null,"Register"))))))}),P=(n(58),function(){var e=Object(r.useState)(""),t=Object(d.a)(e,2),n=t[0],c=t[1],o=Object(r.useState)(""),s=Object(d.a)(o,2),i=s[0],p=s[1],f=Object(r.useContext)(S),v=f.API,h=f.isLoggedIn,g=f.isCheckedLogin,b=function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.Auth.login(t);case 3:n=e.sent,alert(n.msg),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log({error:e.t0}),alert(e.t0.msg);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement(r.Fragment,null,a.a.createElement(L,null),a.a.createElement("div",{className:"login-container"},g?h?a.a.createElement(m.a,{to:"/connect"}):a.a.createElement(r.Fragment,null,a.a.createElement("h3",null,"Login"),a.a.createElement("div",null,a.a.createElement("input",{type:"text",placeholder:"Username",onChange:function(e){return c(e.target.value)},value:n}),a.a.createElement("input",{type:"password",placeholder:"Password",onChange:function(e){return p(e.target.value)},value:i})),a.a.createElement("button",{type:"button",onClick:function(e){return b({username:n,password:i})}},"Login")):"loading"))}),U=function(){var e=Object(r.useState)(""),t=Object(d.a)(e,2),n=t[0],c=t[1],o=Object(r.useState)(""),s=Object(d.a)(o,2),i=s[0],p=s[1],m=Object(r.useState)(""),f=Object(d.a)(m,2),v=f[0],h=f[1],g=Object(r.useState)(""),b=Object(d.a)(g,2),w=b[0],E=b[1],x=Object(r.useContext)(S).API,O=function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.Auth.register(t);case 3:n=e.sent,alert(n.msg),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert(e.t0.msg);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement("div",null,a.a.createElement(L,null),a.a.createElement("h3",null,"Register"),a.a.createElement("div",null,a.a.createElement("input",{type:"text",placeholder:"Username",onChange:function(e){return c(e.target.value)},value:n}),a.a.createElement("input",{type:"email",placeholder:"Email",onChange:function(e){return p(e.target.value)},value:i})),a.a.createElement("div",null,a.a.createElement("input",{type:"password",placeholder:"Password",onChange:function(e){return h(e.target.value)},value:v}),a.a.createElement("input",{type:"password",placeholder:"Repeat Password",onChange:function(e){return E(e.target.value)},value:w})),a.a.createElement("div",null,v?v===w?"Passwords match":"Password do not match":null),a.a.createElement("button",{type:"button",onClick:function(e){return O({username:n,password:v,email:i})}},"Signup"))},I=(n(64),function(e){e.playVideoFromCamera;var t=e.isOnCall;return a.a.createElement("div",null,a.a.createElement("div",{className:t?"padding hidden":"padding"},a.a.createElement("select",{name:"",id:"availableCameras",placeholder:"Choose camera"})),a.a.createElement("div",{id:"caller-details"}),a.a.createElement("button",{className:t?"hidden":"",id:"answer"},"Answer"),a.a.createElement("div",{className:t?"":"hidden"},a.a.createElement("video",{id:"self-video",autoPlay:!0,playsInline:!0,controls:"false"}),a.a.createElement("video",{id:"other-video",autoPlay:!0,playsInline:!0,controls:"false"}),a.a.createElement("div",null,a.a.createElement("button",{id:"disconnect"},"Disconnect"))))}),T=function(e){var t=Object(r.useContext)(S),n=t.isCheckedLogin,c=t.isLoggedIn;return n?c?a.a.createElement(r.Fragment,null,e.children):a.a.createElement(m.a,{to:"/login"}):"loading"},q=(n(65),function(e){var t=e.playVideoFromCamera,n=Object(r.useState)(!1),c=Object(d.a)(n,2),o=c[0],s=c[1],i=Object(r.useState)([]),p=Object(d.a)(i,2),m=p[0],f=p[1],v=Object(r.useState)(""),h=Object(d.a)(v,2),g=h[0],b=h[1],w=Object(r.useState)(""),E=Object(d.a)(w,2),x=E[0],O=E[1],y=Object(r.useContext)(S),j=y.API;y.data.loggedInUser;Object(r.useEffect)((function(){return o||(s(!0),k()),function(){}}));var k=function(){try{j.User.getConnections().then((function(e){f(e)}))}catch(e){alert(e.msg||"Unexpected error while fetching your connections! Please try again")}},C=function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.User.searchUser({searchKey:g});case 3:n=e.sent,O(n),console.log({user:n}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),alert(e.t0.msg||"Unexpected error occured!");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.User.addConnection({connectionId:x._id});case 3:return n=e.sent,e.next=6,k();case 6:alert(n.msg),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),alert(e.t0.msg||"Unexpected error occured!");case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.User.removeConnection({connectionId:t});case 3:return n=e.sent,e.next=6,k();case 6:alert(n.msg),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),alert(e.t0.msg||"Unexpected error occured!");case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement("div",null,a.a.createElement("h3",null,"Connections"),a.a.createElement("h5",null,"Search"),a.a.createElement("input",{type:"text",placeholder:"Search username/email",onChange:function(e){return b(e.target.value)},value:g}),a.a.createElement("button",{type:"button",onClick:C},"Search"),x?a.a.createElement("div",null,a.a.createElement("hr",null),a.a.createElement("div",null,"Username: ",x.username," Email: ",x.email),m.find((function(e){return console.log(e._id,x._id),e._id===x._id}))?"Connected":a.a.createElement("button",{type:"button",onClick:L},"Add Connection"),a.a.createElement("hr",null)):null,a.a.createElement("hr",null),a.a.createElement("h5",null,"My Connections"),a.a.createElement("hr",null),m.map((function(e){return a.a.createElement(r.Fragment,{key:e._id},a.a.createElement("div",null,"Username: ",e.username," Email: ",e.email),a.a.createElement("button",{id:"call-button",type:"button",onClick:function(n){return t(e.username)}},"Call"),a.a.createElement("button",{id:"remove-connection-button",type:"button",onClick:function(t){return P(e._id)}},"Remove Connection"),a.a.createElement("hr",null))})))}),N=(n(66),function(){var e=Object(r.useState)(!1),t=Object(d.a)(e,2),n=t[0],c=t[1],o=Object(r.useState)(!1),s=Object(d.a)(o,2),i=s[0],p=s[1],m=Object(r.useContext)(S),f="",v=function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.API.Auth.logout();case 3:window.location.href="/",e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),alert("Sorry, an unexpected error occured!"),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),h=Object(r.useContext)(S).data.loggedInUser,g=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia(t);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0),alert("Couldn't get Camera. Please ensure camera permissions are granted for the browser and for the website.");case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}();function b(e){return w.apply(this,arguments)}function w(){return(w=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.enumerateDevices();case 3:return n=e.sent,e.abrupt("return",n.filter((function(e){return e.kind===t})));case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),alert("Couldn't get Camera List. Please ensure camera permissions are granted for the browser and for the website.");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function E(e){try{var t=document.querySelector("select#availableCameras");t.innerHTML="",e.map((function(e){var t=document.createElement("option");return t.label=e.label,t.value=e.deviceId,t})).forEach((function(e){t.add(e)}))}catch(n){console.error(n),alert("Unexpected error occured!")}}function x(e,t,n){return O.apply(this,arguments)}function O(){return(O=Object(l.a)(u.a.mark((function e(t,n,r){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={audio:{echoCancellation:!0},video:{deviceId:t,width:{min:n},height:{min:r}}},e.next=4,g(a);case 4:return e.abrupt("return",e.sent);case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),alert("Couldn't get Camera List. Please ensure camera permissions are granted for the browser and for the website.");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}var y=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f=t,e.prev=1,p(!0),n=document.querySelector("select#availableCameras").value,e.next=6,x(n,480,240);case 6:r=e.sent,document.querySelector("video#self-video").srcObject=r,j(r),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),console.error(e.t0),alert("Unexpected error occured!");case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}();function j(e){return k.apply(this,arguments)}function k(){return(k=Object(l.a)(u.a.mark((function e(t){var n,r,a,c,o,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,window.caller=!0,n=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]}),document.querySelector("#disconnect").addEventListener("click",(function(){n.close()})),n.addStream(t),n.getSenders&&(r=n.getSenders()[0].dtmf,console.log({dtmfSender:r})),a="",n.addEventListener("icecandidate",(function(e){if(e.candidate){a=e.candidate.candidate;var t=f;window.socket.emit("new-ice-candidate",{candidate:e.candidate,to:t.value})}})),c=new MediaStream,document.querySelector("video#other-video").srcObject=c,n.addEventListener("track",(function(e){console.log({caller:{track:e}}),c.addTrack(e.track,c)})),n.addEventListener("iceconnectionstatechange",(function(){"failed"!==n.iceConnectionState&&"disconnected"!==n.iceConnectionState&&"closed"!==n.iceConnectionState||(p(!1),n.close())})),window.socket.on("iceCandidate",function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.candidate!==a){e.next=3;break}return console.log("same person"),e.abrupt("return");case 3:return e.next=5,n.addIceCandidate(t.candidate);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),window.socket.on("answer",function(){var e=Object(l.a)(u.a.mark((function e(t){var r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t.answer)){e.next=6;break}return console.log({answer:r}),a=new RTCSessionDescription(r),e.next=6,n.setRemoteDescription(a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=18,n.createOffer();case 18:return o=e.sent,e.next=21,n.setLocalDescription(o);case 21:s=f,console.log({offer:o,connectWith:s}),window.socket.emit("offer",{offer:o,to:s}),n.addEventListener("icecandidateerror",(function(e){console.log({error:e}),alert("Something went wrong. Couldn't connect the call. Please try again.")})),e.next=31;break;case 27:e.prev=27,e.t0=e.catch(0),console.log({error:e.t0}),alert("2Something went wrong. Couldn't connect the call. Please try again.");case 31:case"end":return e.stop()}}),e,null,[[0,27]])})))).apply(this,arguments)}function C(){return(C=Object(l.a)(u.a.mark((function e(){var t,n,r,a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!window.caller){e.next=3;break}return e.abrupt("return");case 3:return t=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]}),document.querySelector("#disconnect").addEventListener("click",(function(){t.close()})),t.addEventListener("iceconnectionstatechange",(function(){"failed"!==t.iceConnectionState&&"disconnected"!==t.iceConnectionState&&"closed"!==t.iceConnectionState||(p(!1),t.close())})),n=document.querySelector("video#self-video"),r=document.querySelector("select#availableCameras").value,e.next=11,x(r,480,240);case 11:a=e.sent,t.addStream(a),c=new MediaStream,document.querySelector("video#other-video").srcObject=c,t.addEventListener("track",(function(e){console.log({answerer:{track:e}}),c.addTrack(e.track,c)})),"",window.socket.on("offer",function(){var e=Object(l.a)(u.a.mark((function e(r){var c,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=r.offer,o=r.from,console.log({from:o,offer:c}),c&&(t.addEventListener("icecandidate",(function(e){if(e.candidate){e.candidate.candidate;document.querySelector("#other-username");window.socket.emit("new-ice-candidate",{candidate:e.candidate,to:o})}})),t.setRemoteDescription(new RTCSessionDescription(c)),document.querySelector("#caller-details").innerHTML=o+" calling",document.querySelector("#answer").addEventListener("click",Object(l.a)(u.a.mark((function e(){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),n.srcObject=a,e.next=4,t.createAnswer();case 4:return r=e.sent,e.next=7,t.setLocalDescription(r);case 7:document.querySelector("#other-username"),window.socket.emit("answer",{answer:r,to:o}),document.querySelector("#caller-details").innerHTML="";case 10:case"end":return e.stop()}}),e)})))));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.addEventListener("icecandidateerror",(function(e){console.log({error:e}),alert("Something went wrong. Couldn't connect the call. Please try again.")})),e.next=26;break;case 22:e.prev=22,e.t0=e.catch(0),console.log({error:e.t0}),alert("Something went wrong. Couldn't connect the call. Please try again.");case 26:case"end":return e.stop()}}),e,null,[[0,22]])})))).apply(this,arguments)}function P(){return(P=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b("videoinput");case 3:E(e.sent),navigator.mediaDevices.addEventListener("devicechange",(function(e){E(b("video"))})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}return Object(r.useEffect)((function(){if(console.log({loggedInUser:h}),h&&!n){c(!0);window.socket=window.io("https://mubashir-video-chat.herokuapp.com/"),window.socket.on("invalid_registration",(function(e){alert(e)})),window.socket.on("invalid_message",(function(e){})),window.socket.on("successful_registration",(function(e){alert(e)})),window.socket.emit("register",h.username),function(){P.apply(this,arguments)}(),function(){C.apply(this,arguments)}()}return function(){}})),a.a.createElement(r.Fragment,null,a.a.createElement(L,null),a.a.createElement("div",{className:"connect-container"},a.a.createElement("div",{className:"sidebar"},a.a.createElement("button",{id:"logout-btn",onClick:v},"Logout"),a.a.createElement(q,{className:i?"hidden":"",playVideoFromCamera:y})),a.a.createElement("div",null,a.a.createElement(I,{playVideoFromCamera:y,isOnCall:i}))))}),A=function(e){return a.a.createElement(p.a,null,a.a.createElement(m.d,null,a.a.createElement(m.b,{path:"/",component:L,exact:!0}),a.a.createElement(m.b,{path:"/login",component:P,exact:!0}),a.a.createElement(m.b,{path:"/register",component:U,exact:!0}),a.a.createElement(m.b,{path:"/call",exact:!0},a.a.createElement(T,null,a.a.createElement(I,null))),a.a.createElement(m.b,{path:"/connections",exact:!0},a.a.createElement(T,null,a.a.createElement(q,null))),a.a.createElement(m.b,{path:"/connect",exact:!0},a.a.createElement(T,null,a.a.createElement(N,null)))))};var D=function(){var e=Object(r.useState)(!1),t=Object(d.a)(e,2),n=t[0],c=t[1],o=Object(r.useState)(!1),i=Object(d.a)(o,2),p=i[0],m=i[1],f=Object(r.useState)(!1),v=Object(d.a)(f,2),h=v[0],g=v[1],b=Object(r.useState)({}),w=Object(d.a)(b,2),E=w[0],x=w[1],y=function(){var e=Object(l.a)(u.a.mark((function e(){var t,n,r=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.login.apply(O,r);case 2:return t=e.sent,e.next=5,O.me.apply(O,r);case 5:return n=e.sent,g(!0),x(n&&n.user||{}),e.abrupt("return",t);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j={Auth:Object(s.a)({},O,{login:y}),User:C};return Object(r.useEffect)((function(){if(console.log("render.."),!n){console.log("checking"),c(!0);try{O.me().then((function(e){x(e&&e.user||{}),g(!0),m(!0)})).catch((function(e){m(!0)}))}catch(e){}}return function(){console.log("unmounting")}}),[1]),a.a.createElement(S.Provider,{value:{API:j,data:{loggedInUser:E},isCheckedLogin:p,isLoggedIn:h}},a.a.createElement("div",{className:"App"},a.a.createElement(A,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(D,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[31,1,2]]]);
//# sourceMappingURL=main.1cc10a2b.chunk.js.map